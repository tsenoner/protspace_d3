<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test ProtSpace Scatterplot</title>

    <!-- 1. Add Import Map -->
    <script type="importmap">
    {
        "imports": {
            "lit": "https://esm.sh/lit@3",
            "lit/decorators.js": "https://esm.sh/lit@3/decorators.js",
            "lit/directives/ref.js": "https://esm.sh/lit@3/directives/ref.js",
            "d3": "https://esm.sh/d3@7",
            "@protspace/utils": "./packages/utils/dist/index.esm.js",
            "d3-scale-chromatic": "https://esm.sh/d3-scale-chromatic@3"
        }
    }
    </script>

    <style>
        body { font-family: sans-serif; margin: 20px; background-color: #f4f4f4; color: #333; }
        h1 { text-align: center; color: #1a1a1a; }
        protspace-scatterplot {
            display: block; /* Ensure it behaves like a block element */
            width: 90vw; /* Responsive width */
            max-width: 1100px; /* Max width like in defaults */
            height: 70vh; /* Responsive height */
            max-height: 600px; /* Max height like in defaults */
            border: 1px solid #ccc;
            margin: 20px auto; /* Center the element */
            background-color: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <h1>ProtSpace Scatterplot Test</h1>

    <protspace-scatterplot id="myPlot"></protspace-scatterplot>

    <!-- 2. Your module script for the component -->
    <script type="module">
        // Import the component. This path is relative to the project root.
        import './packages/core/dist/core.mjs';

        // Wait for the custom element to be defined
        customElements.whenDefined('protspace-scatterplot').then(() => {
            const plotElement = document.getElementById('myPlot');

            if (plotElement) {
                // Minimal data structure based on VisualizationData and PlotDataPoint
                // (Ensure your component can handle potentially missing optional fields gracefully)
                const sampleData = {
                    projections: [
                        {
                            name: "UMAP",
                            data: [ // Corrected from 'coordinates' to 'data'
                                [0.5, 0.5], [0.2, 0.3], [0.8, 0.7], [-0.1, -0.2], [-0.5, 0.1],
                                [0.6, -0.4], [-0.3, 0.6], [0.1, 0.8], [-0.7, -0.7], [0.0, 0.0]
                            ]
                        }
                    ],
                    protein_ids: ["P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "P9", "P10"],
                    features: {
                        "family": {
                            name: "Protein Family",
                            values: ["Kinase", "Protease", "Receptor", "Other"],
                            colors: ["#e41a1c", "#377eb8", "#4daf4a", "#984ea3"],
                            shapes: ["circle", "square", "triangle", "diamond"]
                        },
                        "size_category": {
                            name: "Size",
                            values: ["small", "medium", "large"],
                            colors: ["#ff7f00", "#ffff33", "#a65628"],
                            shapes: ["circle", "circle", "circle"]
                        }
                    },
                    feature_data: {
                        "family": [0, 1, 0, 2, 1, 0, 2, 3, 3, 0],
                        "size_category": [0, 1, 2, 1, 0, 2, 1, 0, 1, 2]
                    },
                    sequences: {} // Optional, can be empty
                };

                // Assign data and properties
                plotElement.data = sampleData;
                plotElement.selectedProjectionIndex = 0;
                plotElement.selectedFeature = "family"; // Default feature to display

                console.log("ProtSpace Scatterplot component loaded and data assigned.");

                // Example of interacting with the component after a delay
                setTimeout(() => {
                    if (plotElement.selectedFeature === "family") {
                        console.log("Switching selected feature to size_category");
                        plotElement.selectedFeature = "size_category";
                    } else {
                        console.log("Switching selected feature to family");
                        plotElement.selectedFeature = "family";
                    }
                }, 5000);

            } else {
                console.error("Could not find the scatterplot element.");
            }
        });
    </script>
</body>
</html> 